<!-- Admin Edit Toggle -->
@if (isAdmin) {
<div class="admin-controls">
    <button class="btn btn-primary me-2" (click)="toggleEditMode()">
        {{ editingMode ? 'Exit Edit Mode' : 'Edit Homepage' }}
    </button>
    @if (editingMode) {
    <button class="btn btn-success" (click)="saveChanges()">
        Save Changes
    </button>
    }
</div>
}

<!-- Hero Section -->
<section class="hero" id="home">
    <div class="hero-container">
        <div class="hero-content">
            <h1 #heroTitle 
                [contentEditable]="editingMode && isAdmin" 
                (blur)="updateContent('hero', 'title', heroTitle.textContent || '')" 
                (click)="startEditing('hero', 'title')"
                [class.editable]="editingMode && isAdmin"
                [innerHTML]="content.hero.title">
            </h1>
            <p #heroSubtitle 
               [contentEditable]="editingMode && isAdmin" 
               (blur)="updateContent('hero', 'subtitle', heroSubtitle.textContent || '')" 
               (click)="startEditing('hero', 'subtitle')"
               [class.editable]="editingMode && isAdmin">
               {{ content.hero.subtitle }}
            </p>
            <div class="hero-buttons">
                <a #heroPrimaryCta href="#collections" class="btn-primary" 
                   [contentEditable]="editingMode && isAdmin" 
                   (blur)="updateContent('hero', 'primaryCta', heroPrimaryCta.textContent || '')" 
                   [class.editable]="editingMode && isAdmin">
                    {{ content.hero.primaryCta }}
                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M17 8l4 4m0 0l-4 4m4-4H3" />
                    </svg>
                </a>
                <a #heroSecondaryCta href="#featured" class="btn-secondary" 
                   [contentEditable]="editingMode && isAdmin" 
                   (blur)="updateContent('hero', 'secondaryCta', heroSecondaryCta.textContent || '')" 
                   [class.editable]="editingMode && isAdmin">
                   {{ content.hero.secondaryCta }}
                </a>
            </div>
        </div>
        <div class="hero-image">
            <img [src]="content.hero.backgroundImage"
                alt="Luxury Living Room">
            @if (editingMode && isAdmin) {
            <div class="hero-bg-upload image-upload-overlay">
                <button class="btn btn-sm btn-primary" (click)="heroImg.click()">
                    Change Background
                </button>
                <input #heroImg type="file" accept="image/*" style="display: none;"
                       (change)="onImageUpload($event, 'hero')">
            </div>
            }
        </div>
    </div>
</section>



<section class="experience-modern">
    <div class="experience-container-modern">
        <div class="experience-header">
            <h2 #experienceTitle class="section-title fade-in" 
                [contentEditable]="editingMode && isAdmin" 
                (blur)="updateContent('experience', 'title', experienceTitle.textContent || '')" 
                (click)="startEditing('experience', 'title')"
                [class.editable]="editingMode && isAdmin">
                {{ content.experience.title }}
            </h2>
            <p #experienceSubtitle class="section-subtitle fade-in" 
               [contentEditable]="editingMode && isAdmin" 
               (blur)="updateContent('experience', 'subtitle', experienceSubtitle.textContent || '')" 
               (click)="startEditing('experience', 'subtitle')"
               [class.editable]="editingMode && isAdmin">
               {{ content.experience.subtitle }}
            </p>
        </div>
        
        <div class="experience-grid-modern">
            <!-- Full width hero card -->
            <div class="experience-card-modern hero-card fade-in">
                <div class="card-background">
                    <img src="https://images.unsplash.com/photo-1586023492125-27b2c045efd7?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80" alt="Craftsmanship">
                    <div class="card-overlay-modern"></div>
                    @if (editingMode && isAdmin) {
                    <div class="image-upload-overlay">
                        <button class="btn btn-sm btn-primary" (click)="card0Img.click()">
                            Change Image
                        </button>
                        <input #card0Img type="file" accept="image/*" style="display: none;"
                               (change)="onImageUpload($event, 'experience', 0)">
                    </div>
                    }
                </div>

                <div class="card-content-modern">
                    <span class="card-number-modern">01</span>
                    <h3 #craftTitle 
                        [contentEditable]="editingMode && isAdmin" 
                        (blur)="updateExperienceContent(0, 'title', craftTitle.textContent || '')" 
                        (click)="startEditing('experience.cards.0', 'title')"
                        [class.editable]="editingMode && isAdmin">
                        {{ content.experience.cards[0].title }}
                    </h3>
                    <p #craftDescription 
                       [contentEditable]="editingMode && isAdmin" 
                       (blur)="updateExperienceContent(0, 'description', craftDescription.textContent || '')" 
                       (click)="startEditing('experience.cards.0', 'description')"
                       [class.editable]="editingMode && isAdmin">
                       {{ content.experience.cards[0].description }}
                    </p>
                    <a #craftLink href="#" class="card-link-modern" 
                       [contentEditable]="editingMode && isAdmin" 
                       (blur)="updateExperienceContent(0, 'link', craftLink.textContent || '')" 
                       (click)="startEditing('experience.cards.0', 'link')"
                       [class.editable]="editingMode && isAdmin">
                       {{ content.experience.cards[0].link }}
                    </a>
                </div>
                
            </div>

            <!-- Vertical cards row -->
            <div class="vertical-cards-row">
                <div class="experience-card-modern vertical-card fade-in">
                    <div class="card-image-modern">
                        <img [src]="content.experience.cards[1].image" alt="{{ content.experience.cards[1].title }}">
                        @if (editingMode && isAdmin) {
                        <div class="image-upload-overlay">
                            <button class="btn btn-sm btn-primary" (click)="card1Img.click()">
                                Change Image
                            </button>
                            <input #card1Img type="file" accept="image/*" style="display: none;"
                                   (change)="onImageUpload($event, 'experience', 1)">
                        </div>
                        }
                    </div>
                    <div class="card-content-modern">
                        <span class="card-number-modern">01</span>
                        <h3 #bespokeTitle 
                            [contentEditable]="editingMode && isAdmin" 
                            (blur)="updateExperienceContent(1, 'title', bespokeTitle.textContent || '')" 
                            (click)="startEditing('experience.cards.1', 'title')"
                            [class.editable]="editingMode && isAdmin">
                            {{ content.experience.cards[1].title }}
                        </h3>
                        <p #bespokeDescription 
                           [contentEditable]="editingMode && isAdmin" 
                           (blur)="updateExperienceContent(1, 'description', bespokeDescription.textContent || '')" 
                           (click)="startEditing('experience.cards.1', 'description')"
                           [class.editable]="editingMode && isAdmin">
                           {{ content.experience.cards[1].description }}
                        </p>
                        <a #bespokeLink href="#" class="card-link-modern" 
                           [contentEditable]="editingMode && isAdmin" 
                           (blur)="updateExperienceContent(1, 'link', bespokeLink.textContent || '')" 
                           (click)="startEditing('experience.cards.1', 'link')"
                           [class.editable]="editingMode && isAdmin">
                           {{ content.experience.cards[1].link }}
                        </a>
                    </div>
                </div>

                <div class="experience-card-modern vertical-card fade-in">
                    <div class="card-image-modern">
                        <img [src]="content.experience.cards[2].image" alt="{{ content.experience.cards[2].title }}">
                        @if (editingMode && isAdmin) {
                        <div class="image-upload-overlay">
                            <button class="btn btn-sm btn-primary" (click)="card2Img.click()">
                                Change Image
                            </button>
                            <input #card2Img type="file" accept="image/*" style="display: none;"
                                   (change)="onImageUpload($event, 'experience', 2)">
                        </div>
                        }
                    </div>
                    <div class="card-content-modern">
                        <span class="card-number-modern">02</span>
                        <h3 #sustainableTitle 
                            [contentEditable]="editingMode && isAdmin" 
                            (blur)="updateExperienceContent(2, 'title', sustainableTitle.textContent || '')" 
                            (click)="startEditing('experience.cards.2', 'title')"
                            [class.editable]="editingMode && isAdmin">
                            {{ content.experience.cards[2].title }}
                        </h3>
                        <p #sustainableDescription 
                           [contentEditable]="editingMode && isAdmin" 
                           (blur)="updateExperienceContent(2, 'description', sustainableDescription.textContent || '')" 
                           (click)="startEditing('experience.cards.2', 'description')"
                           [class.editable]="editingMode && isAdmin">
                           {{ content.experience.cards[2].description }}
                        </p>
                        <a #sustainableLink href="#" class="card-link-modern" 
                           [contentEditable]="editingMode && isAdmin" 
                           (blur)="updateExperienceContent(2, 'link', sustainableLink.textContent || '')" 
                           (click)="startEditing('experience.cards.2', 'link')"
                           [class.editable]="editingMode && isAdmin">
                           {{ content.experience.cards[2].link }}
                        </a>
                    </div>
                </div>

                <div class="experience-card-modern vertical-card fade-in">
                    <div class="card-image-modern">
                        <img [src]="content.experience.cards[3].image" alt="{{ content.experience.cards[3].title }}">
                        @if (editingMode && isAdmin) {
                        <div class="image-upload-overlay">
                            <button class="btn btn-sm btn-primary" (click)="card3Img.click()">
                                Change Image
                            </button>
                            <input #card3Img type="file" accept="image/*" style="display: none;"
                                   (change)="onImageUpload($event, 'experience', 3)">
                        </div>
                        }
                    </div>
                    <div class="card-content-modern">
                        <span class="card-number-modern">03</span>
                        <h3 #warrantyTitle 
                            [contentEditable]="editingMode && isAdmin" 
                            (blur)="updateExperienceContent(3, 'title', warrantyTitle.textContent || '')" 
                            (click)="startEditing('experience.cards.3', 'title')"
                            [class.editable]="editingMode && isAdmin">
                            {{ content.experience.cards[3].title }}
                        </h3>
                        <p #warrantyDescription 
                           [contentEditable]="editingMode && isAdmin" 
                           (blur)="updateExperienceContent(3, 'description', warrantyDescription.textContent || '')" 
                           (click)="startEditing('experience.cards.3', 'description')"
                           [class.editable]="editingMode && isAdmin">
                           {{ content.experience.cards[3].description }}
                        </p>
                        <a #warrantyLink href="#" class="card-link-modern" 
                           [contentEditable]="editingMode && isAdmin" 
                           (blur)="updateExperienceContent(3, 'link', warrantyLink.textContent || '')" 
                           (click)="startEditing('experience.cards.3', 'link')"
                           [class.editable]="editingMode && isAdmin">
                           {{ content.experience.cards[3].link }}
                        </a>
                    </div>
                </div>
            </div>

            <!-- Stats and features section -->
            <div class="stats-features-row">
                <div class="stats-card fade-in">
                    <div class="stats-grid-modern">
                        <div class="stat-item-modern" *ngFor="let stat of content.stats.items; let i = index">
                            <span class="stat-number-modern" 
                                  #statNumber
                                  [contentEditable]="editingMode && isAdmin" 
                                  (blur)="updateStatsContent(i, 'number', statNumber.textContent || '')" 
                                  [class.editable]="editingMode && isAdmin">{{ stat.number }}</span>
                            <span class="stat-label-modern" 
                                  #statLabel
                                  [contentEditable]="editingMode && isAdmin" 
                                  (blur)="updateStatsContent(i, 'label', statLabel.textContent || '')" 
                                  [class.editable]="editingMode && isAdmin">{{ stat.label }}</span>
                        </div>
                    </div>
                </div>

                <div class="features-card fade-in">
                    <h4 #whyChooseTitle 
                        [contentEditable]="editingMode && isAdmin" 
                        (blur)="updateContent('whyChoose', 'title', whyChooseTitle.textContent || '')" 
                        [class.editable]="editingMode && isAdmin">{{ content.whyChoose.title }}</h4>
                    <div class="features-list">
                        <div class="feature-item" *ngFor="let feature of content.whyChoose.features; let i = index">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="20,6 9,17 4,12"></polyline>
                            </svg>
                            <span #featureText
                                  [contentEditable]="editingMode && isAdmin" 
                                  (blur)="updateFeatureContent(i, featureText.textContent || '')" 
                                  [class.editable]="editingMode && isAdmin">{{ feature }}</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Showcase Gallery -->
<section class="showcase-gallery container-fluid" id="featured">
    <div class="gallery-container">
        <div class="gallery-header fade-in">
            <div class="header-content">
                <h2 #galleryTitle 
                    [contentEditable]="editingMode && isAdmin" 
                    (blur)="updateContent('gallery', 'title', galleryTitle.textContent || '')" 
                    (click)="startEditing('gallery', 'title')"
                    [class.editable]="editingMode && isAdmin">
                    {{ content.gallery.title }}
                </h2>
                <p #gallerySubtitle 
                   [contentEditable]="editingMode && isAdmin" 
                   (blur)="updateContent('gallery', 'subtitle', gallerySubtitle.textContent || '')" 
                   (click)="startEditing('gallery', 'subtitle')"
                   [class.editable]="editingMode && isAdmin">
                   {{ content.gallery.subtitle }}
                </p>
            </div>
            <div class="gallery-nav">
                <button class="nav-btn active" data-category="all">All</button>
                <button class="nav-btn" data-category="living">Living</button>
                <button class="nav-btn" data-category="dining">Dining</button>
                <button class="nav-btn" data-category="bedroom">Bedroom</button>
            </div>
        </div>

        <div class="gallery-masonry">
            <div class="gallery-item large living fade-in" data-category="living">
                <div class="item-image">
                    <img [src]="content.gallery.products[0].image" [alt]="content.gallery.products[0].name">
                    @if (editingMode && isAdmin) {
                    <div class="image-upload-overlay">
                        <button class="btn btn-sm btn-primary" (click)="galleryImg0.click()">
                            Change Image
                        </button>
                        <input #galleryImg0 type="file" accept="image/*" style="display: none;"
                               (change)="onImageUpload($event, 'gallery', 0)">
                    </div>
                    }
                    <div class="item-overlay">
                        <div class="item-info">
                            <h3 #product1Name 
                                [contentEditable]="editingMode && isAdmin" 
                                (blur)="updateProductContent(0, 'name', product1Name.textContent || '')" 
                                (click)="startEditing('featured.products.0', 'name')"
                                [class.editable]="editingMode && isAdmin">
                                {{ content.gallery.products[0].name }}
                            </h3>
                            <p #product1Price class="item-price" 
                               [contentEditable]="editingMode && isAdmin" 
                               (blur)="updateProductContent(0, 'price', product1Price.textContent || '')" 
                               (click)="startEditing('featured.products.0', 'price')"
                               [class.editable]="editingMode && isAdmin">
                               {{ content.gallery.products[0].price }}
                            </p>
                            <button #product1Button class="quick-view" 
                                    [contentEditable]="editingMode && isAdmin" 
                                    (blur)="updateProductContent(0, 'buttonText', product1Button.textContent || '')" 
                                    (click)="startEditing('featured.products.0', 'buttonText')"
                                    [class.editable]="editingMode && isAdmin">
                                    {{ content.gallery.products[0].button || 'Quick View' }}
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="gallery-item medium dining fade-in" data-category="dining">
                <div class="item-image">
                    <img [src]="content.gallery.products[1].image" [alt]="content.gallery.products[1].name">
                    @if (editingMode && isAdmin) {
                    <div class="image-upload-overlay">
                        <button class="btn btn-sm btn-primary" (click)="galleryImg1.click()">
                            Change Image
                        </button>
                        <input #galleryImg1 type="file" accept="image/*" style="display: none;"
                               (change)="onImageUpload($event, 'gallery', 1)">
                    </div>
                    }
                    <div class="item-overlay">
                        <div class="item-info">
                            <h3 #product2Name 
                                [contentEditable]="editingMode && isAdmin" 
                                (blur)="updateProductContent(1, 'name', product2Name.textContent || '')" 
                                (click)="startEditing('featured.products.1', 'name')"
                                [class.editable]="editingMode && isAdmin">
                                {{ content.gallery.products[1].name }}
                            </h3>
                            <p #product2Price class="item-price" 
                               [contentEditable]="editingMode && isAdmin" 
                               (blur)="updateProductContent(1, 'price', product2Price.textContent || '')" 
                               (click)="startEditing('featured.products.1', 'price')"
                               [class.editable]="editingMode && isAdmin">
                               {{ content.gallery.products[1].price }}
                            </p>
                            <button #product2Button class="quick-view" 
                                    [contentEditable]="editingMode && isAdmin" 
                                    (blur)="updateProductContent(1, 'buttonText', product2Button.textContent || '')" 
                                    (click)="startEditing('featured.products.1', 'buttonText')"
                                    [class.editable]="editingMode && isAdmin">
                                    {{ content.gallery.products[1].button || 'Quick View' }}
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="gallery-item small bedroom fade-in" data-category="bedroom">
                <div class="item-image">
                    <img [src]="content.gallery.products[2].image" [alt]="content.gallery.products[2].name">
                    @if (editingMode && isAdmin) {
                    <div class="image-upload-overlay">
                        <button class="btn btn-sm btn-primary" (click)="galleryImg2.click()">
                            Change Image
                        </button>
                        <input #galleryImg2 type="file" accept="image/*" style="display: none;"
                               (change)="onImageUpload($event, 'gallery', 2)">
                    </div>
                    }
                    <div class="item-overlay">
                        <div class="item-info">
                            <h3 #product3Name 
                                [contentEditable]="editingMode && isAdmin" 
                                (blur)="updateProductContent(2, 'name', product3Name.textContent || '')" 
                                (click)="startEditing('featured.products.2', 'name')"
                                [class.editable]="editingMode && isAdmin">
                                {{ content.gallery.products[2].name }}
                            </h3>
                            <p #product3Price class="item-price" 
                               [contentEditable]="editingMode && isAdmin" 
                               (blur)="updateProductContent(2, 'price', product3Price.textContent || '')" 
                               (click)="startEditing('featured.products.2', 'price')"
                               [class.editable]="editingMode && isAdmin">
                               {{ content.gallery.products[2].price }}
                            </p>
                            <button #product3Button class="quick-view" 
                                    [contentEditable]="editingMode && isAdmin" 
                                    (blur)="updateProductContent(2, 'buttonText', product3Button.textContent || '')" 
                                    (click)="startEditing('featured.products.2', 'buttonText')"
                                    [class.editable]="editingMode && isAdmin">
                                    {{ content.gallery.products[2].button || 'Quick View' }}
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="gallery-item wide living fade-in" data-category="living">
                <div class="item-content">
                    <div class="content-text">
                        <h3 #artisanTitle [contentEditable]="editingMode && isAdmin" (blur)="updateContent('artisan', 'title', artisanTitle.textContent || '')" [class.editable]="editingMode && isAdmin">{{ content.artisan.title }}</h3>
                        <p #artisanDescription [contentEditable]="editingMode && isAdmin" (blur)="updateContent('artisan', 'description', artisanDescription.textContent || '')" [class.editable]="editingMode && isAdmin">{{ content.artisan.description }}</p>
                        <a #artisanLink href="#" class="content-link" [contentEditable]="editingMode && isAdmin" (blur)="updateContent('artisan', 'link', artisanLink.textContent || '')" [class.editable]="editingMode && isAdmin">{{ content.artisan.link }}</a>
                    </div>
                    <div class="content-image">
                        <img [src]="content.artisan.image || 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&q=80'"
                            alt="Craftsperson">
                        @if (editingMode && isAdmin) {
                        <div class="image-upload-overlay">
                            <button class="btn btn-sm btn-primary" (click)="artisanImg.click()">
                                Change Image
                            </button>
                            <input #artisanImg type="file" accept="image/*" style="display: none;"
                                   (change)="onImageUpload($event, 'artisan', 'image')">
                        </div>
                        }
                    </div>
                </div>
            </div>

            <div class="gallery-item tall dining fade-in" data-category="dining">
                <div class="item-image">
                    <img [src]="content.gallery.dining.image || 'https://images.unsplash.com/photo-1449824913935-59a10b8d2000?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80'"
                        alt="Dining Experience">
                    @if (editingMode && isAdmin) {
                    <div class="image-upload-overlay">
                        <button class="btn btn-sm btn-primary" (click)="diningImg.click()">
                            Change Image
                        </button>
                        <input #diningImg type="file" accept="image/*" style="display: none;"
                               (change)="onImageUpload($event, 'gallery.dining', 'image')">
                    </div>
                    }
                    <div class="item-overlay">
                        <div class="item-info">
                            <h3 #diningTitle [contentEditable]="editingMode && isAdmin" (blur)="updateContent('gallery.dining', 'title', diningTitle.textContent || '')" [class.editable]="editingMode && isAdmin">{{ content.gallery.dining.title }}</h3>
                            <p #diningDescription class="item-description" [contentEditable]="editingMode && isAdmin" (blur)="updateContent('gallery.dining', 'description', diningDescription.textContent || '')" [class.editable]="editingMode && isAdmin">{{ content.gallery.dining.description }}</p>
                            <button #diningButton class="quick-view" [contentEditable]="editingMode && isAdmin" (blur)="updateContent('gallery.dining', 'button', diningButton.textContent || '')" [class.editable]="editingMode && isAdmin">{{ content.gallery.dining.button }}</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="gallery-item medium bedroom fade-in" data-category="bedroom">
                <div class="item-image">
                    <img [src]="content.gallery.products[3].image" [alt]="content.gallery.products[3].name">
                    @if (editingMode && isAdmin) {
                    <div class="image-upload-overlay">
                        <button class="btn btn-sm btn-primary" (click)="galleryImg3.click()">
                            Change Image
                        </button>
                        <input #galleryImg3 type="file" accept="image/*" style="display: none;"
                               (change)="onImageUpload($event, 'gallery', 3)">
                    </div>
                    }
                    <div class="item-overlay">
                        <div class="item-info">
                            <h3 #sanctuaryName [contentEditable]="editingMode && isAdmin" (blur)="updateProductContent(3, 'name', sanctuaryName.textContent || '')" [class.editable]="editingMode && isAdmin">{{ content.gallery.products[3].name }}</h3>
                            <p #sanctuaryPrice class="item-price" [contentEditable]="editingMode && isAdmin" (blur)="updateProductContent(3, 'price', sanctuaryPrice.textContent || '')" [class.editable]="editingMode && isAdmin">{{ content.gallery.products[3].price }}</p>
                            <button #sanctuaryButton class="quick-view" [contentEditable]="editingMode && isAdmin" (blur)="updateProductContent(3, 'button', sanctuaryButton.textContent || '')" [class.editable]="editingMode && isAdmin">{{ content.gallery.products[3].button }}</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Newsletter -->
<section class="newsletter">
    <div class="newsletter-container">
        <h2 #newsletterTitle class="text-white" [contentEditable]="true" (blur)="updateContent('newsletter', 'title', newsletterTitle.textContent || '')" [class.editable]="true">Stay Connected</h2>
        <p #newsletterText [contentEditable]="true" (blur)="updateContent('newsletter', 'text', newsletterText.textContent || '')" [class.editable]="true">Be the first to discover our latest collections, exclusive designs, and special offers crafted just for you.
        </p>
        <form class="newsletter-form">
            <input type="email" class="newsletter-input" placeholder="Enter your email address" required>
            <button type="submit" class="newsletter-btn">Subscribe</button>
        </form>
    </div>
</section>